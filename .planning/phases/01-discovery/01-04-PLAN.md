---
phase: 01-discovery
plan: 04
type: execute
---

<objective>
Create module dependency map and synthesize all Phase 1 discovery findings.

Purpose: Complete the discovery phase by mapping project-level dependencies and consolidating all findings into a coherent picture.
Output: Module dependency diagram, consolidated discovery summary, and readiness assessment for Phase 2.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-discovery/01-01-SUMMARY.md
@.planning/phases/01-discovery/01-02-SUMMARY.md
@.planning/phases/01-discovery/01-03-SUMMARY.md

**From previous plans:**
- 01-01: File inventory, project status, folder structure
- 01-02: Call graph coverage, gaps, architectural insights
- 01-03: FFmpeg P/Invoke documentation

**Projects to map:**
- host/Ams.Cli → host/Ams.Core (primary dependency)
- host/Ams.Core → host/Ams.Dsp.Native (?)
- host/Ams.Web.* → various dependencies
- host/Ams.Tests → references all?
</context>

<tasks>

<task type="auto">
  <name>Task 1: Analyze project references</name>
  <files>.planning/phases/01-discovery/MODULE-DEPS-RAW.md</files>
  <action>
    For each .csproj file:

    1. Read the file and extract all ProjectReference entries
    2. Extract all PackageReference entries (external dependencies)
    3. Note any conditional references (platform-specific, etc.)

    Create MODULE-DEPS-RAW.md with:
    - Section per project
    - Table: Reference Type | Reference Name | Version (if package)
    - Note any circular or unusual references
  </action>
  <verify>MODULE-DEPS-RAW.md exists with all project references documented</verify>
  <done>Every project reference and package reference extracted</done>
</task>

<task type="auto">
  <name>Task 2: Create module dependency diagram</name>
  <files>.planning/phases/01-discovery/MODULE-DEPS-DIAGRAM.md</files>
  <action>
    From MODULE-DEPS-RAW.md, create visual dependency diagram:

    1. Draw project-level dependency graph (text-based, Mermaid-compatible)
    2. Identify layers: CLI hosts → Core → Native
    3. Show which projects are isolated (no dependents)
    4. Highlight the core pipeline path

    Create MODULE-DEPS-DIAGRAM.md with:
    - Mermaid diagram syntax showing dependencies
    - Layer analysis (presentation, application, domain, infrastructure)
    - Notes on dependency health (tight coupling, etc.)
  </action>
  <verify>MODULE-DEPS-DIAGRAM.md exists with visual diagram</verify>
  <done>Project dependency graph visualized and analyzed</done>
</task>

<task type="auto">
  <name>Task 3: Synthesize Phase 1 discovery findings</name>
  <files>.planning/phases/01-discovery/DISCOVERY-SYNTHESIS.md</files>
  <action>
    Consolidate all Phase 1 findings into executive summary:

    1. Read all 4 plan summaries (01-01, 01-02, 01-03, this plan)
    2. Compile key metrics: file counts, coverage percentages, project statuses
    3. Summarize architectural observations
    4. Identify questions answered and new questions raised
    5. Assess readiness for Phase 2 (Pipeline Analysis)

    Create DISCOVERY-SYNTHESIS.md with:
    - Executive summary (1-2 paragraphs)
    - Key metrics table
    - Architectural observations
    - Open questions for Phase 2
    - Phase 2 readiness assessment
  </action>
  <verify>DISCOVERY-SYNTHESIS.md exists with consolidated findings</verify>
  <done>All Phase 1 findings synthesized and Phase 2 readiness assessed</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] MODULE-DEPS-RAW.md exists with all references
- [ ] MODULE-DEPS-DIAGRAM.md exists with visual diagram
- [ ] DISCOVERY-SYNTHESIS.md exists with consolidated findings
- [ ] Dependency graph shows clear layering
- [ ] Phase 2 readiness is assessed
</verification>

<success_criteria>

- All 3 tasks completed
- All verification checks pass
- Phase 1 Discovery is complete
- Clear picture of codebase structure established
- Ready to proceed to Phase 2 (Pipeline Analysis)
</success_criteria>

<output>
After completion, create `.planning/phases/01-discovery/01-04-SUMMARY.md`:

# Phase 1 Plan 4: Module Dependency Map Summary

**[Substantive one-liner about dependency structure findings]**

## Accomplishments

- [Dependency graph completed]
- [Phase 1 synthesized]
- [Readiness for Phase 2 confirmed]

## Files Created

- `.planning/phases/01-discovery/MODULE-DEPS-RAW.md` - Raw reference data
- `.planning/phases/01-discovery/MODULE-DEPS-DIAGRAM.md` - Visual dependency graph
- `.planning/phases/01-discovery/DISCOVERY-SYNTHESIS.md` - Phase 1 synthesis

## Decisions Made

[Observations about module organization]

## Issues Encountered

[Problems found, or "None"]

## Next Step

Phase 1 complete. Ready for Phase 2 (Pipeline Analysis).
</output>
