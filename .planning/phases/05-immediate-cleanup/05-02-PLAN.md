---
phase: 05-immediate-cleanup
plan: 02
type: execute
---

<objective>
Fix the DateTime warning and remove the unnecessary IMfaService interface.

Purpose: Eliminate build warning and remove interface that adds no value (not DI registered, not mocked).
Output: Zero warnings, cleaner MfaService without redundant interface.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-immediate-cleanup/05-01-SUMMARY.md

**Prior decisions affecting this phase:**
- AUD-021: DateTime warning in Validation.razor line 365
- AUD-015: IMfaService interface not used in DI, not mocked in tests

**From STATE.md decisions:**
- IMfaService interface: REMOVE (verified not DI registered, not mocked in tests)
- IBook* interfaces: KEEP (different - those ARE DI registered)

**Issue IDs addressed:** AUD-015, AUD-021
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix DateTime warning in Validation.razor</name>
  <files>host/Ams.Web.Client/Pages/Validation.razor</files>
  <action>
    1. Read Validation.razor and locate line 365 (or nearby) with DateTime usage
    2. Identify the specific warning - likely using DateTime.Now or DateTime.UtcNow
    3. Replace with DateTimeOffset.Now or DateTimeOffset.UtcNow as appropriate
    4. Ensure timezone handling is correct for the context

    WHY: DateTime is ambiguous regarding timezone. DateTimeOffset explicitly includes offset,
    which is the recommended pattern for modern .NET applications. This fixes warning CS8600
    or similar DateTime-related compiler warnings.

    NOTE: Do NOT change any other DateTime usages in the file - only fix the warning location.
  </action>
  <verify>
    - Build with no warnings: `dotnet build host/Ams.Web.Client --no-restore 2>&1 | Select-String "warning"`
    - File still compiles: Build succeeds
  </verify>
  <done>DateTime warning eliminated, Validation.razor builds with 0 warnings</done>
</task>

<task type="auto">
  <name>Task 2: Remove IMfaService interface</name>
  <files>host/Ams.Core/Application/Mfa/MfaService.cs</files>
  <action>
    1. First verify IMfaService is NOT in DI registration:
       - Search for "IMfaService" in Program.cs or DI setup files
       - Confirm no `services.AddScoped<IMfaService>` or similar
    2. Verify IMfaService is NOT mocked in tests:
       - `Select-String -Recurse "IMfaService" tests/ -Include "*.cs"`
       - Should find 0 results
    3. Read MfaService.cs to understand current structure
    4. Remove the IMfaService interface definition (if defined in same file)
    5. If interface is in separate file, delete that file
    6. Remove `: IMfaService` from class declaration
    7. Update any callers that reference IMfaService type to use MfaService directly

    WHY: Interface provides no value - not used for DI abstraction, not mocked in tests.
    Following the pattern from STATE.md: "IMfaService interface: REMOVE"
  </action>
  <verify>
    - No IMfaService references remain: `Select-String -Recurse "IMfaService" host/ -Include "*.cs"`
    - Build succeeds: `dotnet build host/Ams.Core --no-restore`
    - Tests pass: `dotnet test tests/Ams.Tests --no-restore`
  </verify>
  <done>IMfaService interface removed, all callers use MfaService directly, build and tests pass</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `dotnet build` succeeds for entire solution with 0 warnings
- [ ] `dotnet test` passes all tests
- [ ] No IMfaService references remain in codebase
</verification>

<success_criteria>
- DateTime warning in Validation.razor fixed
- IMfaService interface completely removed
- Solution builds with 0 warnings
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/05-immediate-cleanup/05-02-SUMMARY.md`:

# Phase 5 Plan 02: Fix Warning & Remove Interface Summary

**[One-liner describing the fixes]**

## Accomplishments

- Fixed DateTime warning in Validation.razor (line 365)
- Removed unused IMfaService interface

## Files Modified

- `host/Ams.Web.Client/Pages/Validation.razor` - DateTime -> DateTimeOffset
- `host/Ams.Core/Application/Mfa/MfaService.cs` - Removed interface implementation

## Files Deleted

- [List any interface files deleted, or "None"]

## Issues Addressed

- AUD-015: IMfaService unnecessary interface
- AUD-021: DateTime warning

## Decisions Made

None - decisions made in v1.0 audit (IMfaService: REMOVE).

## Issues Encountered

[Document any unexpected references, or "None"]

## Next Step

Ready for 05-03-PLAN.md (Archive dormant projects)
</output>
