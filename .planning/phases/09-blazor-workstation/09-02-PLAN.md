---
phase: 09-blazor-workstation
plan: 2
type: execute
---

<objective>
Create the main layout shell with Prep/Proof/Polish area navigation and a book/chapter selection landing page.

Purpose: Establish the core navigation structure and entry point for the workstation.
Output: Working navigation between areas, chapter selection page that displays available chapters.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-blazor-workstation/09-RESEARCH.md
@.planning/phases/09-blazor-workstation/09-CONTEXT.md
@.planning/phases/09-blazor-workstation/09-01-SUMMARY.md

**From CONTEXT.md - Three-area architecture:**
- **Prep** - Pipeline orchestration, setting up chapters for processing
- **Proof** - Validation and review (port of current validation-viewer)
- **Polish** - Take replacement, batch editing, prosody analysis (future)

First phase focuses on foundation + Proof area. Prep and Polish are placeholder areas.

**Layout pattern from RESEARCH.md:**
```razor
<div class="workstation-layout">
    <nav class="area-nav">
        <NavLink href="/prep" Match="NavLinkMatch.Prefix">Prep</NavLink>
        <NavLink href="/proof" Match="NavLinkMatch.Prefix">Proof</NavLink>
        <NavLink href="/polish" Match="NavLinkMatch.Prefix">Polish</NavLink>
    </nav>
    <main class="area-content">
        @Body
    </main>
</div>
```

**Ams.Core integration for chapter listing:**
@host/Ams.Core/Runtime/Book/BookContext.cs
@host/Ams.Core/Runtime/Chapter/ChapterManager.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MainLayout with Prep/Proof/Polish navigation</name>
  <files>host/Ams.Workstation.Server/Components/Layout/MainLayout.razor, host/Ams.Workstation.Server/Components/Layout/MainLayout.razor.css, host/Ams.Workstation.Server/Components/Layout/NavMenu.razor, host/Ams.Workstation.Server/wwwroot/css/app.css</files>
  <action>
    Replace the template MainLayout with workstation-specific layout:

    1. MainLayout.razor - Desktop-oriented shell with:
       - Top header bar with app title "AMS Workstation"
       - Left sidebar with area navigation (Prep/Proof/Polish)
       - Main content area for @Body
       - Use NavLink components with NavLinkMatch.Prefix for area routing

    2. MainLayout.razor.css - Scoped styles for:
       - Fixed sidebar (200-250px width)
       - Full-height layout
       - Active nav item highlighting
       - Dark theme base (matches validation-viewer aesthetic)

    3. NavMenu.razor - Separate navigation component:
       - Three NavLink items for /prep, /proof, /polish
       - Icons if desired (optional - can use text only initially)
       - Active state styling

    4. app.css - Base styles:
       - CSS reset/normalize
       - Dark theme variables (--bg-primary, --bg-secondary, --text-primary, etc.)
       - Font family (system fonts)

    Design should be functional/minimal - we can enhance styling later.
  </action>
  <verify>
    - `dotnet build host/Ams.Workstation.Server` succeeds
    - App runs and shows sidebar with Prep/Proof/Polish links
  </verify>
  <done>MainLayout with three-area navigation renders correctly</done>
</task>

<task type="auto">
  <name>Task 2: Create landing page with book/chapter selection</name>
  <files>host/Ams.Workstation.Server/Components/Pages/Home.razor, host/Ams.Workstation.Server/Components/Pages/Home.razor.css, host/Ams.Workstation.Server/Services/WorkstationState.cs</files>
  <action>
    Create the landing page that allows selecting a book and viewing chapters:

    1. WorkstationState.cs - Simple state service for current session:
       ```csharp
       public class WorkstationState
       {
           public string? BookPath { get; set; }
           public string? CurrentChapter { get; set; }
           public List<string> AvailableChapters { get; set; } = new();
       }
       ```
       Register as Scoped in Program.cs (each circuit gets own state)

    2. Home.razor (@page "/") - Landing page with:
       - Text input or file picker for book path (.md file)
       - "Open Book" button
       - Once book loaded: Display list of available chapters
       - Each chapter is a link to /proof/{chapterName}

    3. For now, use a simple text input for book path (file picker requires JS interop - defer)
       - Store path in WorkstationState
       - On "Open Book": Parse book to get chapter list
       - Display chapters as clickable list

    4. Home.razor.css - Styles for:
       - Centered content area
       - Input field styling
       - Chapter list styling (cards or simple list)

    Note: Full Ams.Core BookContext integration is complex - for this plan, just demonstrate
    the navigation flow. Use placeholder chapter list if needed. Full integration in Plan 4.
  </action>
  <verify>
    - Home page renders at /
    - Can enter a book path
    - Chapter list displays (placeholder or real)
    - Clicking chapter navigates to /proof/{chapter}
  </verify>
  <done>Landing page with book path input and chapter list navigation works</done>
</task>

<task type="auto">
  <name>Task 3: Create placeholder area pages</name>
  <files>host/Ams.Workstation.Server/Components/Pages/Prep/Index.razor, host/Ams.Workstation.Server/Components/Pages/Proof/Index.razor, host/Ams.Workstation.Server/Components/Pages/Proof/ChapterReview.razor, host/Ams.Workstation.Server/Components/Pages/Polish/Index.razor</files>
  <action>
    Create placeholder pages for each area to verify routing:

    1. Prep/Index.razor (@page "/prep"):
       - Simple placeholder: "Prep Area - Pipeline orchestration coming soon"

    2. Proof/Index.razor (@page "/proof"):
       - List of chapters (from WorkstationState) with links to review
       - Or message "Select a book from Home to see chapters"

    3. Proof/ChapterReview.razor (@page "/proof/{ChapterName}"):
       - Route parameter for chapter name
       - Placeholder: "Reviewing chapter: {ChapterName}"
       - This is where waveform + sentence list will go (Plan 3-4)

    4. Polish/Index.razor (@page "/polish"):
       - Simple placeholder: "Polish Area - Take replacement coming in future phase"

    All pages should use @layout MainLayout (inherited from _Imports.razor).
  </action>
  <verify>
    - Navigation to /prep shows Prep placeholder
    - Navigation to /proof shows Proof index
    - Navigation to /proof/Chapter01 shows ChapterReview with "Chapter01"
    - Navigation to /polish shows Polish placeholder
    - NavLinks highlight correctly for current area
  </verify>
  <done>All area pages created, routing works, nav highlighting correct</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Main layout shell with Prep/Proof/Polish navigation and chapter selection flow</what-built>
  <how-to-verify>
    1. Run: `dotnet run --project host/Ams.Workstation.Server`
    2. Open browser to http://localhost:5000 (or port shown in console)
    3. Verify: Sidebar shows Prep/Proof/Polish links
    4. Click each nav link - verify pages render and nav highlights correctly
    5. On Home page: Enter any text as "book path", click Open
    6. Verify: Chapter list appears (placeholder is OK)
    7. Click a chapter - verify navigates to /proof/{chapter}
    8. Check: Dark theme applied, layout looks reasonable
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `dotnet build host/Ams.Workstation.Server` succeeds
- [ ] MainLayout shows sidebar with three area links
- [ ] Home page has book path input and chapter list
- [ ] All area pages render correctly
- [ ] Routing works for /prep, /proof, /proof/{chapter}, /polish
- [ ] NavLink active states work correctly
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Human verified layout looks and navigates correctly
- Ready for waveform component (Plan 3)
</success_criteria>

<output>
After completion, create `.planning/phases/09-blazor-workstation/09-02-SUMMARY.md`:

# Phase 9 Plan 2: Layout Shell & Navigation Summary

**[One-liner describing what was built]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 09-03-PLAN.md (Waveform Component & JS Interop)
</output>
