@using Ams.Web.Dtos

<MudStack Spacing="2">
    <MudText Typo="Typo.subtitle2">Timecodes</MudText>
    <MudDivider />

    @if (Sentences.Count == 0)
    {
        <MudStack AlignItems="AlignItems.Center" Class="pa-4">
            <MudText Typo="Typo.caption" Color="Color.Secondary">â€”</MudText>
        </MudStack>
    }
    else
    {
        <MudList T="string" Dense="true">
            @foreach (var sentence in Sentences)
            {
                <MudListItem Selected="@(sentence == SelectedSentence)">
                    @if (sentence.Timing != null)
                    {
                        <MudStack Spacing="0">
                            <MudText Typo="Typo.body2" Style="font-family: 'Consolas', monospace;">
                                @FormatTime(sentence.Timing.Start)
                            </MudText>
                            <MudText Typo="Typo.caption" Color="Color.Secondary" Style="font-family: 'Consolas', monospace;">
                                @FormatDuration(sentence.Timing.Duration)
                            </MudText>
                            <MudText Typo="Typo.body2" Style="font-family: 'Consolas', monospace;">
                                @FormatTime(sentence.Timing.End)
                            </MudText>
                        </MudStack>
                    }
                    else
                    {
                        <MudText Typo="Typo.caption" Color="Color.Error">No timing</MudText>
                    }
                </MudListItem>
                <MudDivider />
            }
        </MudList>
    }
</MudStack>

@code {
    [Parameter] public IReadOnlyList<SentenceDto> Sentences { get; set; } = Array.Empty<SentenceDto>();
    [Parameter] public SentenceDto? SelectedSentence { get; set; }

    private static string FormatTime(double seconds)
    {
        var ts = TimeSpan.FromSeconds(seconds);
        return $"{ts:mm\\:ss\\.fff}";
    }

    private static string FormatDuration(double seconds)
    {
        var ts = TimeSpan.FromSeconds(seconds);
        return $"({ts:s\\.fff}s)";
    }
}
