@using Ams.Web.Dtos

@if (Sentences.Count == 0)
{
    <MudStack AlignItems="AlignItems.Center" Class="pa-8">
        <MudText Typo="Typo.body1" Color="Color.Secondary">No sentences loaded</MudText>
    </MudStack>
}
else
{
    <MudList T="string" Dense="true">
        @foreach (var sentence in Sentences)
        {
            <MudListItem Class="ma-5" OnClick="@(() => OnSentenceClick(sentence))"
                         Selected="@(sentence == SelectedSentence)">
                <MudStack Row="true" AlignItems="AlignItems.Start" Spacing="2">
                    <MudText Typo="Typo.caption" Color="Color.Secondary" Style="min-width: 50px; text-align: right; font-family: 'Consolas', monospace;">
                        @sentence.Id
                    </MudText>

                    <MudStack Spacing="1" Class="flex-grow-1">
                        <MudText Typo="Typo.body1">@sentence.BookText</MudText>
                        @if (!string.IsNullOrEmpty(sentence.ScriptText) && sentence.ScriptText != sentence.BookText)
                        {
                            <MudText Typo="Typo.body2" Color="Color.Warning" Style="font-style: italic;">
                                Script: @sentence.ScriptText
                            </MudText>
                        }
                    </MudStack>

                    @if (sentence.Diff != null && (sentence.Diff.Stats.Insertions > 0 || sentence.Diff.Stats.Deletions > 0))
                    {
                        <MudStack Row="true" Spacing="1">
                            @if (sentence.Diff.Stats.Insertions > 0)
                            {
                                <MudIcon Icon="@Icons.Material.Filled.Add" Size="Size.Small" Color="Color.Success" />
                            }
                            @if (sentence.Diff.Stats.Deletions > 0)
                            {
                                <MudIcon Icon="@Icons.Material.Filled.Remove" Size="Size.Small" Color="Color.Error" />
                            }
                        </MudStack>
                    }
                </MudStack>
            </MudListItem>
        }
    </MudList>
}

@code {
    [Parameter] public IReadOnlyList<SentenceDto> Sentences { get; set; } = Array.Empty<SentenceDto>();
    [Parameter] public SentenceDto? SelectedSentence { get; set; }
    [Parameter] public EventCallback<SentenceDto> OnSentenceSelected { get; set; }

    private async Task OnSentenceClick(SentenceDto sentence)
    {
        await OnSentenceSelected.InvokeAsync(sentence);
    }
}
